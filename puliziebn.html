<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista di Pulizie Settimanali</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        h1 {
            color: #007bff;
            text-align: center;
            margin-bottom: 30px;
        }
        .day-section {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding: 15px;
        }
        h2 {
            color: #28a745;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 5px;
            margin-top: 0;
            cursor: pointer; /* Rende il titolo cliccabile per espandere/comprimere */
        }
        ul {
            list-style: none;
            padding: 0;
            margin-top: 10px;
        }
        li {
            padding: 8px 0;
            border-bottom: 1px dashed #e9ecef;
            display: flex;
            align-items: center;
        }
        li:last-child {
            border-bottom: none;
        }
        input[type="checkbox"] {
            margin-right: 10px;
            min-width: 18px; /* Assicura che la checkbox sia visibile e cliccabile */
            min-height: 18px;
            cursor: pointer;
        }
        .completed {
            text-decoration: line-through;
            color: #6c757d;
        }
        .reset-button {
            display: block;
            width: 100%;
            padding: 10px;
            margin-top: 20px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .reset-button:hover {
            background-color: #c82333;
        }
    </style>
</head>
<body>

    <h1>ðŸ“‹ Lista di Pulizie Settimanali</h1>

    <div id="cleaning-list">
        </div>

    <button class="reset-button" onclick="resetAll()">Reset Completo</button>

    <script>
        // Struttura della lista di pulizie
        const weeklyTasks = {
            "LunedÃ¬": ["Struttura Forno", "Scaffali Pizza", "Vetri e Plexiglass"],
            "MartedÃ¬": ["Bagno", "Banco Pizza", "Congelatore"],
            "MercoledÃ¬": ["Scaffalatura teglie", "Scaffali Bancone", "Rifornimento Scaffali"],
            "GiovedÃ¬": ["Lavello", "Scaffali Biscotti", "Pulizia Bancone Avanti"],
            "VenerdÃ¬": ["Frigo Bibite", "Bagno", "Giacenza"],
            "Sabato": ["Lavare scopa", "Filtro aspirapolvere"],
            "Tutte le sere": ["Secchi spazzatura", "Spazzare", "Spolverare", "Lavare i pavimenti", "Pulizia utensili e pennelli"]
        };

        const storageKey = 'weeklyCleaningData';
        let cleaningData = JSON.parse(localStorage.getItem(storageKey)) || {};

        /**
         * Genera l'HTML per la lista e applica lo stato salvato.
         */
        function renderList() {
            const listContainer = document.getElementById('cleaning-list');
            listContainer.innerHTML = ''; // Pulisce il contenitore

            for (const day in weeklyTasks) {
                const dayId = day.replace(/\s+/g, '-').toLowerCase(); // ID pulito per il giorno

                // Inizializza i dati per il giorno se non esistono
                if (!cleaningData[dayId]) {
                    cleaningData[dayId] = weeklyTasks[day].map(() => false); // false per "non completato"
                }

                let html = `<div class="day-section" id="${dayId}">`;
                html += `<h2>${day}</h2>`;
                html += `<ul>`;

                weeklyTasks[day].forEach((task, index) => {
                    const isChecked = cleaningData[dayId][index];
                    const completedClass = isChecked ? 'completed' : '';

                    html += `<li class="${completedClass}">
                                <input type="checkbox" 
                                       id="${dayId}-task-${index}" 
                                       data-day="${dayId}" 
                                       data-index="${index}" 
                                       ${isChecked ? 'checked' : ''} 
                                       onchange="toggleTask(this)">
                                <label for="${dayId}-task-${index}">${task}</label>
                            </li>`;
                });

                html += `</ul></div>`;
                listContainer.innerHTML += html;
            }
        }

        /**
         * Gestisce il cambio di stato della checkbox e salva i dati.
         * @param {object} checkboxElement - L'elemento checkbox che Ã¨ stato cliccato.
         */
        function toggleTask(checkboxElement) {
            const dayId = checkboxElement.getAttribute('data-day');
            const index = parseInt(checkboxElement.getAttribute('data-index'));
            const isChecked = checkboxElement.checked;
            const listItem = checkboxElement.closest('li');

            // 1. Aggiorna lo stato nel modello dati
            cleaningData[dayId][index] = isChecked;

            // 2. Aggiorna l'aspetto visivo
            if (isChecked) {
                listItem.classList.add('completed');
            } else {
                listItem.classList.remove('completed');
            }

            // 3. Salva i dati aggiornati
            saveData();
        }

        /**
         * Salva l'oggetto cleaningData nel localStorage.
         */
        function saveData() {
            localStorage.setItem(storageKey, JSON.stringify(cleaningData));
        }

        /**
         * Resetta tutti i dati di completamento.
         */
        function resetAll() {
            if (confirm("Sei sicuro di voler resettare tutta la lista di pulizia? Tutte le spunte verranno rimosse.")) {
                localStorage.removeItem(storageKey);
                cleaningData = {}; // Resetta il modello dati
                renderList(); // Ridisegna la lista
                alert("Lista di pulizia resettata!");
            }
        }

        // Carica la lista all'avvio della pagina
        document.addEventListener('DOMContentLoaded', renderList);
    </script>

</body>
</html>